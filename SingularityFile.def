Bootstrap: docker
From: mfisherman/openmpi

%labels
    Author danielepiano

%files
    ./build/main mx-multiplication

    # Copy matrix samples to run the executable with
    matrixA.txt
    matrixB.txt

%runscript
    echo ">> Container started..."
    mpirun -np 2 mx-multiplication

%test
    # Check if required files exist
    echo ">> Verifying required files exist..."
    if [[ ! -x mx-multiplication ]]; then
        echo ">> !! Missing: mx-multiplication"
    fi
    if [[ ! -f matrixA.txt ]]; then
        echo ">> !! Missing: matrixA.txt"
    fi
    if [[ ! -f matrixB.txt ]]; then
        echo ">> !! Missing: matrixB.txt"
    fi
    echo ">> Check completed."

%help
    This is a container hosting a mini-app to perform matrix multiplication, exploiting parallelism via MPI.
    The status quo is: the two matrices are hardcoded, only 2 processes may run concurrently.